<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://unpkg.com/bamboo.css" />
  <title>CrearProducto</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
  <body>
    <header>
      <nav>
        <ul>
          <a href="index.html"><li>Ver</li></a>
          <a href="consultar.html"><li>Consultar id</li></a>
          <a href="crear.html"><li>Crear</li></a>
          <a href="modificar.html"><li>Modificar</li></a>
          <a href="eliminar.html"><li>Eliminar</li></a>
        </ul>
      </nav>
    </header>

    <main>
      <h1>Consultar producto por ID</h1>
      <hr />

      <form id="altaProductsForm">
        <label>Nombre del producto:</label>
        <input
          type="text"
          name="name"
          required
        />

        <label>URL de la imagen:</label>
        <input
          type="url"
          name="image"
          required
        />

        <label>Categor√≠a:</label>
        <select name="category" required>
          <option value="impresora">Impresora</option>
          <option value="cartucho">Cartucho</option>
        </select>

        <label>Precio:</label>
        <input type="number" name="price" required />

        <button type="submit">Crear producto</button>
      </form>

      <ul id="listaProductos"></ul>
    </main>

    <script>
      let url = "http://localhost:3000/api/productos";

      const altaProductsForm = document.querySelector("#altaProductsForm");
      const listaProductos = document.querySelector("#listaProductos");

      altaProductsForm.addEventListener("submit", async (event) => {
        event.preventDefault(); 

        
        let formData = new FormData(event.target);

        
        let data = Object.fromEntries(formData.entries());

        try {
          let response = await fetch(url, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          });

          let result = await response.json();

          if (response.ok) {
            console.log(result.message);
            alert(`Producto creado con exito con id: ${result.productId}`);
          } else {
            alert(`Error en la creacion de producto: ${result.message}`);
          }
        } catch (error) {
          console.error("Error al enviar los datos: ", error);
          alert("Error al procesar la solicitud");
        }
      });
    </script>
  </body>
</html>
